/*!
/* broadcast-event - v1.0.0
 * @description A simple way to fire JavaScript events across iframes.
 * https://github.com/orca-scan/broadcast-event
 * @author Orca Scan <orcascan.com>
 * @license MIT
 */
!function(e){"use strict";if("function"!=typeof e.CustomEvent)throw new Error("missing CustomEvent polyfill");if("function"!=typeof e.EventTarget)throw new Error("missing EventTarget polyfill");var t=e.location.href,n=[],o=!0;function r(n,r,d){if(n=String(n||"")||"",r=r||{},o=!0===d,-1===n.indexOf(":"))throw new Error("eventName must be namespaced with :");if(!i(r)){var f={type:n,detail:r,sender:t,timestamp:Date.now()};if(a("fired:",f),e.dispatchEvent(new CustomEvent(n,r)),e.top!==e)s(e.top,f);else for(var l=0,c=e.frames.length;l<c;l++)s(e.frames[l],f)}}function a(){if(o){var e=["broadcast-event["+t+"]"].concat([].slice.call(arguments));console.log.apply(console,e)}}function i(e){if(!e)throw new Error("Invalid payload param");var t=e.eventIds||[];return n.some(function(e){return-1!==t.indexOf(e)})}function s(o,r){if(o!==e&&!i(r.detail)){var s=function(e){for(var t=2166136261,n=0;n<e.length;n++)t^=e.charCodeAt(n),t+=(t<<1)+(t<<4)+(t<<7)+(t<<8)+(t<<24);return Math.abs(t>>>0).toString(36)}(t+":"+r.type+":"+performance.now()+":"+Math.random());r.detail.eventIds=r.detail.eventIds||[],r.detail.eventIds.push(s),n.push(s),n.length>1e3&&n.splice(0,n.length-1e3);try{a("sent:",r),o.postMessage({_broadcast:r},"*")}catch(e){}}}e.addEventListener("message",function(e){var t=e.data&&e.data._broadcast;t&&"string"==typeof t.type&&t.detail&&(a("received:",t),r(t.type,t.detail))}),"undefined"!=typeof module&&module.exports?module.exports=r:e.broadcastEvent=r}(this);